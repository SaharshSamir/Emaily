(this.webpackJsonpstub=this.webpackJsonpstub||[]).push([[0],{236:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"fetchUser",(function(){return k})),n.d(r,"handleToken",(function(){return N})),n.d(r,"submitSurvey",(function(){return S})),n.d(r,"fetchSurveys",(function(){return C}));var a=n(1),c=(n(113),n(0)),s=n(53),i=n.n(s),u=n(9),o=n(7),l=n(108),j=n(15),d=n(16),b=n(18),h=n(17),p=n(23),v=n(8),f=n(24),O=n.n(f),m=n(42),x=n(30),y=n.n(x),w="fetch_user",g="fetch_surveys",k=function(){return function(){var e=Object(m.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get("/api/current_user");case 2:n=e.sent,t({type:w,payload:n.data});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},N=function(e){return function(){var t=Object(m.a)(O.a.mark((function t(n){var r;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.a.post("/api/stripe",e);case 2:r=t.sent,n({type:w,payload:r.data});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},S=function(e,t){return function(){var n=Object(m.a)(O.a.mark((function n(r){var a;return O.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,y.a.post("/api/surveys",e);case 2:a=n.sent,t.push("/surveys"),r({type:w,payload:a.data});case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},C=function(){return function(){var e=Object(m.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get("/api/surveys");case 2:n=e.sent,t({type:g,payload:n.data});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},F=n(109),_=n.n(F),A=function(e){Object(b.a)(n,e);var t=Object(h.a)(n);function n(){return Object(j.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return Object(a.jsx)(_.a,{name:"Emaily",description:"$5 for 5 email credits",amount:500,token:function(t){return e.props.handleToken(t)},stripeKey:"pk_test_dKZxavK0k1eMgsN9MFM9oPBh",children:Object(a.jsx)("button",{className:"btn",children:"Add Credits"})})}}]),n}(c.Component),B=Object(u.b)(null,r)(A),E=function(e){Object(b.a)(n,e);var t=Object(h.a)(n);function n(){return Object(j.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"renderContent",value:function(){switch(this.props.auth){case null:return;case!1:return Object(a.jsx)("li",{children:Object(a.jsx)("a",{href:"/auth/google",children:"Login With Google"})});default:return[Object(a.jsx)("li",{children:Object(a.jsx)(B,{})},"1"),Object(a.jsxs)("li",{style:{margin:"0 10px"},children:["Credits: ",this.props.auth.credits]},"3"),Object(a.jsx)("li",{children:Object(a.jsx)("a",{href:"/api/logout",children:"Logout"})},"2")]}}},{key:"render",value:function(){return Object(a.jsx)("nav",{children:Object(a.jsxs)("div",{className:"nav-wrapper",children:[Object(a.jsx)(p.b,{to:this.props.auth?"/surveys":"/",className:"left brand-logo",children:"Emaily"}),Object(a.jsx)("ul",{className:"right",children:this.renderContent()})]})})}}]),n}(c.Component);var L=Object(u.b)((function(e){return{auth:e.auth}}))(E),M=function(){return Object(a.jsxs)("div",{style:{textAlign:"center"},children:[Object(a.jsx)("h1",{children:"Emaily!"}),"Collect feedback form your users"]})},R=function(e){Object(b.a)(n,e);var t=Object(h.a)(n);function n(){return Object(j.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"componentDidMount",value:function(){this.props.fetchSurveys()}},{key:"renderSurveys",value:function(){return this.props.surveys.reverse().map((function(e){return Object(a.jsxs)("div",{className:"darken-2 blue-grey card",children:[Object(a.jsxs)("div",{className:"card-content white-text",children:[Object(a.jsx)("span",{className:"card-title",children:e.title}),Object(a.jsx)("p",{children:e.body}),Object(a.jsxs)("p",{className:"right",children:["Sent On: ",new Date(e.dateSent).toLocaleDateString()]})]}),Object(a.jsxs)("div",{className:"card-action",children:[Object(a.jsxs)("a",{children:["Yes: ",e.yes]}),Object(a.jsxs)("a",{children:["No: ",e.no]})]})]},e._id)}))}},{key:"render",value:function(){return Object(a.jsx)("div",{children:this.renderSurveys()})}}]),n}(c.Component);var D=Object(u.b)((function(e){return{surveys:e.surveys}}),{fetchSurveys:C})(R),T=function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)(D,{}),Object(a.jsx)("div",{className:"fixed-action-btn",children:Object(a.jsx)(p.b,{to:"/surveys/new",className:"btn-floating btn-large red",children:Object(a.jsx)("i",{className:"material-icons",children:"add"})})})]})},Z=n(38),$=n.n(Z),z=n(238),K=n(237),U=n(76),J=function(e){var t=e.input,n=e.label,r=e.meta,c=r.error,s=r.touched;return Object(a.jsxs)("div",{children:[Object(a.jsx)("label",{children:n}),Object(a.jsx)("input",Object(U.a)(Object(U.a)({},t),{},{style:{marginBottom:"5px"}})),Object(a.jsx)("div",{className:"red-text",style:{marginBottom:"20px"},children:s&&c})]})},P=/^[a-zA-Z0-9.!#$%&\u2019*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,V=[{label:"Survey Title",name:"title"},{label:"Subject Line",name:"subject"},{label:"Email Body",name:"body"},{label:"Recipeient List",name:"recipients"}],Y=function(e){Object(b.a)(n,e);var t=Object(h.a)(n);function n(){return Object(j.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"renderFields",value:function(){return $.a.map(V,(function(e){var t=e.label,n=e.name;return Object(a.jsx)(z.a,{component:J,type:"text",label:t,name:n},n)}))}},{key:"render",value:function(){return Object(a.jsx)("div",{children:Object(a.jsxs)("form",{onSubmit:this.props.handleSubmit(this.props.onSurveySubmit),children:[this.renderFields(),Object(a.jsx)(p.b,{to:"/surveys",className:"red btn-flat white-text",children:"Cancel"}),Object(a.jsxs)("button",{type:"submit",className:"teal btn-flat right white-text",children:["Next",Object(a.jsx)("i",{className:"material-icons right",children:"done"})]})]})})}}]),n}(c.Component);var q=Object(K.a)({validate:function(e){var t={};return t.recipients=function(e){var t=e.replace(/(,|,\s)$/,"").split(",").map((function(e){return e.trim()})).filter((function(e){return!1===P.test(e)}));if(t.length)return"These emails are invalid: ".concat(t)}(e.recipients||""),$.a.each(V,(function(n){var r=n.name;e[r]||(t[r]="You must provide a value")})),t},form:"surveyForm",destroyOnUnmount:!1})(Y);var G=Object(u.b)((function(e){return{formValues:e.form.surveyForm.values}}),r)(Object(v.e)((function(e){var t=e.onCancel,n=e.formValues,r=e.submitSurvey,c=e.history,s=$.a.map(V,(function(e){var t=e.name,r=e.label;return Object(a.jsxs)("div",{style:{margin:"30px"},children:[Object(a.jsx)("label",{children:r}),Object(a.jsx)("div",{children:n[t]})]},t)}));return Object(a.jsxs)("div",{children:[Object(a.jsx)("h5",{children:"Please confirm your survey"}),s,Object(a.jsx)("button",{className:"yellow darken-3 white-text btn-flat",onClick:t,children:"Back"}),Object(a.jsxs)("button",{onClick:function(){return r(n,c)},className:"green btn-flat white-text right",children:["Send Email",Object(a.jsx)("i",{className:"material-icons right ",children:"email"})]})]})}))),W=function(e){Object(b.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(j.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={showFormReview:!1},e}return Object(d.a)(n,[{key:"renderContent",value:function(){var e=this;return this.state.showFormReview?Object(a.jsx)(G,{onCancel:function(){return e.setState({showFormReview:!1})}}):Object(a.jsx)(q,{onSurveySubmit:function(){return e.setState({showFormReview:!0})}})}},{key:"render",value:function(){return Object(a.jsx)("div",{children:this.renderContent()})}}]),n}(c.Component),H=Object(K.a)({form:"surveyForm"})(W),I=function(e){Object(b.a)(n,e);var t=Object(h.a)(n);function n(){return Object(j.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"componentDidMount",value:function(){this.props.fetchUser()}},{key:"render",value:function(){return Object(a.jsx)("div",{className:"container",children:Object(a.jsx)(p.a,{children:Object(a.jsxs)("div",{children:[Object(a.jsx)(L,{}),Object(a.jsx)(v.a,{exact:!0,path:"/",component:M}),Object(a.jsx)(v.a,{exact:!0,path:"/surveys",component:T}),Object(a.jsx)(v.a,{path:"/surveys/new",component:H})]})})})}}]),n}(c.Component),Q=Object(u.b)(null,r)(I),X=n(239),ee=Object(o.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return t.payload||!1;default:return e}},form:X.a,surveys:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return t.payload;default:return e}}});window.axios=y.a;var te=Object(o.d)(ee,{},Object(o.a)(l.a));i.a.render(Object(a.jsx)(u.a,{store:te,children:Object(a.jsx)(Q,{})}),document.querySelector("#root"))}},[[236,1,2]]]);
//# sourceMappingURL=main.a23e9d2e.chunk.js.map